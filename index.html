<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cultural Coinage Generator</title>

    <!-- React + Babel for in-browser JSX transformation -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #111827; color: #d1d5db; }
        .scrolling-panel::-webkit-scrollbar { width: 8px; }
        .scrolling-panel::-webkit-scrollbar-track { background: transparent; }
        .scrolling-panel::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        /**
         * Cultural Coinage Generator
         *
         * Philosophy:
         * This project is about inventing new names that blend cultural and linguistic origins 
         * with thematic inspiration. The agent acts as an expert scholar to provide 
         * context-aware, poetic suggestions, learning from user feedback.
         */
        const { useState, useEffect, useRef } = React;
        
        // --- 1. CONFIGURATION & DATA ---
        const API_BASE_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-preview-05-20:generateContent";
        const themeOptions = ["Nature", "Cosmic", "Balance", "Strength", "Water", "Light", "Shadow", "Music"];
        const styleOptions = ["Lyrical & Melodic", "Archaic & Mythic", "Minimalist & Modern", "Heroic & Resonant"];
        const blacklist = ["tuna", "ilay", "baran", "nur", "solren", "kuzel", "anal"];

        // --- 2. CORE LOGIC & PROMPTING ---
        const createSystemPrompt = (taskPrompt) => { /* ... createSystemPrompt logic ... */ return `...`; };
        const getSyllableCount = (word) => { /* ... syllable counting logic ... */ return 1; };
        const parseAndProcessResponse = (responseText) => { /* ... parsing and scoring logic ... */ return []; };

        // --- 3. UI COMPONENTS ---
        const PhilosophyModal = ({ onClose }) => ( /* ... Modal Component ... */ );
        const NameCard = ({ item, onLike, isLiked }) => ( /* ... Name Card Component ... */ );

        const PromptDisplayCard = ({ prompt }) => {
            const [copied, setCopied] = useState(false);
            const handleCopy = () => {
                navigator.clipboard.writeText(prompt);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };
            return (
                <div className="bg-gray-800 border border-gray-700 rounded-lg p-4 h-full flex flex-col">
                    <div className="flex justify-between items-center mb-2">
                        <h3 className="text-lg font-bold text-white">Generated Prompt</h3>
                        <button onClick={handleCopy} className="text-sm bg-blue-600 text-white font-semibold px-3 py-1 rounded-md hover:bg-blue-700">
                            {copied ? 'Copied!' : 'Copy Prompt'}
                        </button>
                    </div>
                    <p className="text-xs text-gray-400 mb-4">No API key found. Copy this prompt and paste it into your preferred LLM.</p>
                    <pre className="text-sm text-gray-300 bg-gray-900 rounded-md p-4 overflow-auto whitespace-pre-wrap flex-grow">
                        {prompt}
                    </pre>
                </div>
            );
        };
        
        // --- 4. MAIN APPLICATION ---
        function App() {
            // State initialization from Local Storage
            const getInitialState = (key, defaultValue) => { /* ... getInitialState logic ... */ return defaultValue; };
            
            const [apiKey, setApiKey] = useState(() => getInitialState('apiKey', ''));
            const [results, setResults] = useState([]);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);
            const [showPhilosophy, setShowPhilosophy] = useState(false);
            const [likedNames, setLikedNames] = useState(() => getInitialState('likedNames', []));
            const [generatedPrompt, setGeneratedPrompt] = useState(null); // New state for no-API-key mode

            // ... other state variables and useEffect for saving state ...

            const handleLike = (nameObject) => { /* ... handleLike logic ... */ };
            const handleAddLanguage = () => { /* ... language add logic ... */ };
            const handleRemoveLanguage = (langToRemove) => { /* ... language remove logic ... */ };

            const executePrompt = async (prompt) => {
                setIsLoading(true);
                setError(null);
                setResults([]);
                setGeneratedPrompt(null);

                // --- DUAL MODE LOGIC ---
                if (!apiKey) {
                    setGeneratedPrompt(prompt);
                    setIsLoading(false);
                    return;
                }

                // API Mode (existing logic)
                try {
                    // ... API call and retry logic ...
                } catch (err) {
                    // ... error handling ...
                } finally {
                    setIsLoading(false);
                }
            };

            const handleGenerateFirstNames = () => {
                let task;
                // ... logic to build the first name prompt task ...
                executePrompt(createSystemPrompt(task));
            };

            const handleSuggestMiddleNames = () => {
                // ... logic to build the middle name prompt task ...
                executePrompt(createSystemPrompt(task));
            };

            return (
                <>
                    {showPhilosophy && <PhilosophyModal onClose={() => setShowPhilosophy(false)} />}
                    <div className="min-h-screen w-full flex flex-col md:flex-row">
                        {/* Left Panel: Controls */}
                        <div className="w-full md:w-1/3 md:max-w-md h-auto md:h-screen flex flex-col p-4 md:p-6 bg-gray-900 border-b md:border-b-0 md:border-r border-gray-700 overflow-y-auto scrolling-panel">
                            {/* ... Header and other controls ... */}
                            <div className="mt-6">
                                <div className="space-y-2">
                                    <button onClick={handleGenerateFirstNames} disabled={isLoading} className="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:bg-blue-700 disabled:bg-blue-400">
                                        {isLoading ? 'Consulting...' : (apiKey ? (likedNames.length > 0 ? 'Riff on Liked Names' : 'Generate First Names') : 'Generate Prompt for First Names')}
                                    </button>
                                     <button onClick={handleSuggestMiddleNames} disabled={isLoading} className="w-full bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 disabled:bg-gray-400 text-sm">
                                        {isLoading ? 'Consulting...' : (apiKey ? 'Suggest Middle Names' : 'Generate Prompt for Middle Names')}
                                    </button>
                                </div>
                                <button onClick={() => setShowPhilosophy(true)} className="text-sm text-gray-400 hover:text-white text-center w-full mt-4">Show Philosophy</button>
                            </div>
                        </div>

                        {/* Right Panel: Conditional Results Display */}
                        <div className="w-full md:w-2/3 flex-grow p-4 md:p-6 scrolling-panel overflow-y-auto">
                            {isLoading && <div className="flex h-full items-center justify-center text-center">Consulting the agent...</div>}
                            {error && <div className="flex h-full items-center justify-center text-center text-red-400 bg-red-900/50 p-4 rounded-md">{error}</div>}
                            
                            {!isLoading && !error && (
                                <>
                                    {generatedPrompt && <PromptDisplayCard prompt={generatedPrompt} />}
                                    
                                    {results.length > 0 && (
                                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                                            {results.map(item => (
                                                <NameCard 
                                                    key={item.name} 
                                                    item={item} 
                                                    onLike={handleLike} 
                                                    isLiked={likedNames.some(n => n.name === item.name)} 
                                                />
                                            ))}
                                        </div>
                                    )}

                                    {!generatedPrompt && results.length === 0 && (
                                        <div className="flex h-full items-center justify-center text-center text-gray-500">
                                            <p>Your culturally coined names will appear here.</p>
                                        </div>
                                    )}
                                </>
                            )}
                        </div>
                    </div>
                </>
            );
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>


