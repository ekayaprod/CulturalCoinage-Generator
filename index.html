<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cultural Coinage Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #111827; color: #d1d5db; }
        .name-card, .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .scrolling-panel::-webkit-scrollbar { width: 8px; }
        .scrolling-panel::-webkit-scrollbar-track { background: transparent; }
        .scrolling-panel::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
    </style>
</head>
<body class="h-screen">
    <div id="root" class="h-full flex flex-col"></div>

    <script>
        /**
         * Cultural Coinage Generator
         * --------------------------
         * This project fuses linguistic, cultural, and thematic influences to create evocative new names.
         * - Language Origins: Nordic, Turkish, Latin, Celtic, etc.
         * - Styles: Poetic, Modern, Mystical, etc.
         * - Themes: Nature, Cosmic, Mythic, Oceanic, etc.
         *
         * Philosophy: Names are cultural coinages â€” inventions that feel rooted in tradition but point forward. 
         * The tool should always balance clarity (easy to spell/pronounce) with richness (evocative and layered).
         *
         * Future AI agents: Please honor this vision when extending functionality.
         */

        const API_BASE_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent";
        
        // --- STATE MANAGEMENT ---
        let appState = {
            apiKey: "",
            isLoading: false,
            error: null,
            results: [],
            isControlsOpen: false,
            selectedLanguages: ["Celtic", "Sanskrit"],
            selectedThemes: ["Light", "Balance"],
            selectedStyle: "Lyrical & Melodic",
        };

        const root = document.getElementById('root');

        // --- API INTEGRATION ---
        async function callGeminiAPI(prompt) {
            if (!appState.apiKey) throw new Error("API Key is missing.");
            const response = await fetch(`${API_BASE_URL}?key=${appState.apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            if (!response.ok) {
                const errorBody = await response.text();
                throw new Error(`API Error ${response.status}: ${errorBody}`);
            }
            const data = await response.json();
            return data?.candidates?.[0]?.content?.parts?.[0]?.text || "";
        }

        // --- CORE LOGIC ---
        async function executeGeneration() {
            appState.isLoading = true;
            appState.error = null;
            render();

            const prompt = `Generate cultural coinage names using the following inputs: [${appState.selectedLanguages.join(', ')}], [${appState.selectedThemes.join(', ')}], [${appState.selectedStyle}]. Return ONLY a valid JSON array of objects, where each object has "name", "roots", and "meaning" keys.`;

            try {
                const responseText = await callGeminiAPI(prompt);
                let cleanText = responseText.trim();
                if (cleanText.startsWith('```json')) {
                    cleanText = cleanText.replace(/```json\s*/, '').replace(/```\s*$/, '');
                }
                const names = JSON.parse(cleanText);
                appState.results = Array.isArray(names) ? names : [];
            } catch (err) {
                appState.error = "Something went wrong. Please check your API key or network connection.";
                console.error("Raw API Error:", err);
            } finally {
                appState.isLoading = false;
                render();
            }
        }
        
        // --- UI RENDERING ---
        function render() {
            root.innerHTML = '';

            const header = document.createElement('header');
            header.className = "w-full bg-gray-900/80 backdrop-blur-sm border-b border-gray-700 p-4 flex items-center justify-between sticky top-0 z-20";
            header.innerHTML = `
                <h1 class="text-lg font-bold text-white">Cultural Coinage Generator</h1>
                <button data-action="toggleControls" class="text-gray-300 hover:text-white p-2 rounded-full mr-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                </button>
            `;

            const main = document.createElement('main');
            main.id = 'main-content';
            main.className = 'flex-grow p-6 overflow-y-auto';

            if (appState.error) {
                main.innerHTML = `<div class="text-red-400 bg-red-900/50 p-4 rounded-md animate-fade-in">${appState.error}</div>`;
            } else if (appState.isLoading) {
                 main.innerHTML = `<div class="flex h-full items-center justify-center text-center"><svg class="animate-spin h-8 w-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg></div>`;
            } else if (appState.results.length > 0) {
                 const grid = document.createElement('div');
                 grid.className = "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4";
                 appState.results.forEach(item => {
                     const card = document.createElement('div');
                     card.className = "bg-gray-800 border border-gray-700 rounded-lg p-4 flex flex-col name-card";
                     card.innerHTML = `
                        <div class="flex justify-between items-start">
                           <h3 class="text-2xl font-bold text-white pr-2">${item.name}</h3>
                           <button class="copy-btn text-gray-400 hover:text-white" title="Copy name" data-action="copyName" data-name="${item.name}">
                               <svg class="w-6 h-6 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                           </button>
                        </div>
                        <p class="text-gray-300 italic my-2">"${item.meaning || '...'}"</p>
                        <p class="text-xs text-gray-500 mt-auto"><span class="font-semibold">Roots:</span> ${item.roots || '...'}</p>
                     `;
                     grid.appendChild(card);
                 });
                 main.appendChild(grid);
            } else {
                main.innerHTML = '<div class="flex h-full items-center justify-center text-center text-gray-500"><p>Your generated names will appear here.</p></div>';
            }

            root.append(header, main);

            if (appState.isControlsOpen) {
                root.append(createControlsDrawer());
            }
        }
        
        function createControlsDrawer() {
            const drawerContainer = document.createElement('div');
            drawerContainer.className = 'fixed inset-0 z-30 animate-fade-in';
            drawerContainer.innerHTML = `<div class="fixed inset-0 bg-black/60" data-action="toggleControls"></div>`;
            
            const drawer = document.createElement('div');
            drawer.className = "fixed top-0 left-0 h-full w-full max-w-xs sm:max-w-sm bg-gray-900 border-r border-gray-700 z-50 p-4 scrolling-panel overflow-y-auto";
            drawer.innerHTML = `
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-white">Controls</h2>
                    <button data-action="toggleControls" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                </div>
                <div class="space-y-4">
                    <div>
                        <label for="apiKey" class="block text-sm font-medium text-gray-300">API Key</label>
                        <input type="password" id="apiKey" value="${appState.apiKey}" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white mt-1">
                    </div>
                     <div>
                        <label for="languages" class="block text-sm font-medium text-gray-300">Languages</label>
                        <input type="text" id="languages" value="${appState.selectedLanguages.join(', ')}" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white mt-1">
                    </div>
                    <div>
                        <label for="themes" class="block text-sm font-medium text-gray-300">Themes</label>
                        <input type="text" id="themes" value="${appState.selectedThemes.join(', ')}" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white mt-1">
                    </div>
                    <div>
                        <label for="style" class="block text-sm font-medium text-gray-300">Style</label>
                        <input type="text" id="style" value="${appState.selectedStyle}" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white mt-1">
                    </div>
                    <button data-action="generate" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow-lg">Generate</button>
                    <button data-action="clear" class="w-full bg-gray-600 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded">Clear Results</button>
                </div>
            `;
            drawerContainer.appendChild(drawer);
            return drawerContainer;
        }

        // --- EVENT HANDLERS ---
        function handleAction(e) {
            const target = e.target.closest('[data-action]');
            if (!target) return;

            const action = target.dataset.action;

            switch(action) {
                case 'toggleControls':
                    appState.isControlsOpen = !appState.isControlsOpen;
                    render();
                    break;
                case 'generate':
                    appState.apiKey = document.getElementById('apiKey').value;
                    appState.selectedLanguages = document.getElementById('languages').value.split(',').map(s => s.trim());
                    appState.selectedThemes = document.getElementById('themes').value.split(',').map(s => s.trim());
                    appState.selectedStyle = document.getElementById('style').value;
                    appState.isControlsOpen = false; // Close drawer on generate
                    executeGeneration();
                    break;
                case 'clear':
                    appState.results = [];
                    appState.error = null;
                    render();
                    break;
                case 'copyName':
                    navigator.clipboard.writeText(target.dataset.name);
                    break;
            }
        }
        
        //--- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            root.addEventListener('click', handleAction);
            render();
        });

    </script>
</body>
</html>


